import re # regex

from binascii import unhexlify
from cipherspec import *

ciphertext = "5ec0245e54dc7f4cbbc4941577d4f7ddab198caab78702646c1d853c6912a7d7f4052ba72c3ae6"
nonce = "aab55d811f9e312a7cf589de98157163"

offset = 3

for i in range(2 ** 24):
	key = bytearray(b'\x00' * (KEYLEN - offset)) 
	key.extend(i.to_bytes(3, "little"))

	msg = str(dec(key, unhexlify(ciphertext), unhexlify(nonce)))
	
	if re.search("flag{([0-9]|[a-z])+}", msg):
		print(msg) # flag found!
		break